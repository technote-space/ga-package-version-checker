import { GitHub } from '@actions/github/lib/github';
import { Context } from '@actions/github/lib/context';
import { Response, GitCreateTreeResponse, GitCreateCommitResponse, PullsCreateResponse, PullsUpdateResponse } from '@octokit/rest';
import { Logger } from './index';
declare type PullsCreateParams = {
    body?: string;
    draft?: boolean;
    title: string;
};
/**
 * API Helper
 */
export default class ApiHelper {
    private readonly logger;
    private readonly branch?;
    private readonly sender?;
    private readonly suppressBPError?;
    private readonly refForUpdate?;
    private prCache;
    /**
     * @param {Logger} logger logger
     * @param {object} options options
     * @param {string|undefined} options.branch branch
     * @param {string|undefined} options.sender sender
     * @param {string|undefined} options.refForUpdate ref for update
     * @param {boolean|undefined} options.suppressBPError suppress branch protection error?
     */
    constructor(logger: Logger, options?: {
        branch?: string;
        sender?: string;
        refForUpdate?: string;
        suppressBPError?: boolean;
    });
    /**
     * @param {Context} context context
     * @return {string|boolean} sender
     */
    private getSender;
    /**
     * @param {boolean} encode encode?
     * @param {GitHub} octokit octokit
     * @param {Context} context context
     * @return {string} ref for update
     */
    private getRefForUpdate;
    /**
     * @param {string} rootDir root dir
     * @param {string} filepath filepath
     * @param {GitHub} octokit octokit
     * @param {Context} context context
     * @return {Promise<{ path: string, sha: string }>} blob
     */
    private createBlob;
    /**
     * @param {Context} context context
     * @return {string} commit sha
     */
    private getCommitSha;
    /**
     * @param {GitHub} octokit octokit
     * @param {Context} context context
     * @return {Promise<Response<GitGetCommitResponse>>} commit
     */
    private getCommit;
    /**
     * @param {GitHub} octokit octokit
     * @param {Context} context context
     * @return {Promise<Response<PullsGetResponse>>} commit
     */
    private getPR;
    /**
     * @param {string} rootDir root dir
     * @param {object} files files
     * @param {GitHub} octokit octokit
     * @param {Context} context context
     * @return {Promise<{ path: string, sha: string }[]>} blobs
     */
    filesToBlobs: (rootDir: string, files: object, octokit: GitHub, context: Context) => Promise<{
        path: string;
        sha: string;
    }[]>;
    /**
     * @param {{ path: string, sha: string }[]} blobs blobs
     * @param {GitHub} octokit octokit
     * @param {Context} context context
     * @return {Promise<Response<GitCreateTreeResponse>>} tree
     */
    createTree: (blobs: {
        path: string;
        sha: string;
    }[], octokit: GitHub, context: Context) => Promise<Response<GitCreateTreeResponse>>;
    /**
     * @param {string} commitMessage commit message
     * @param {Response<GitCreateTreeResponse>} tree tree
     * @param {GitHub} octokit octokit
     * @param {Context} context context
     * @return {Promise<Response<GitCreateCommitResponse>>} commit
     */
    createCommit: (commitMessage: string, tree: Response<GitCreateTreeResponse>, octokit: GitHub, context: Context) => Promise<Response<GitCreateCommitResponse>>;
    /**
     * @param {string} refName refName
     * @param {GitHub} octokit octokit
     * @param {Context} context context
     * @return {Promise<AnyResponse|null>} refName
     */
    private getRef;
    /**
     * @param {Response<GitCreateCommitResponse>} commit commit
     * @param {GitHub} octokit octokit
     * @param {Context} context context
     * @return {Promise<void>} void
     */
    updateRef: (commit: Response<GitCreateCommitResponse>, octokit: GitHub, context: Context) => Promise<boolean>;
    /**
     * @param {Response<GitCreateCommitResponse>} commit commit
     * @param {string} refName refName
     * @param {GitHub} octokit octokit
     * @param {Context} context context
     * @return {Promise<void>} void
     */
    createRef: (commit: Response<GitCreateCommitResponse>, refName: string, octokit: GitHub, context: Context) => Promise<void>;
    /**
     * @param {string} branchName branch name
     * @param {GitHub} octokit octokit
     * @param {Context} context context
     * @return {Promise<Response<PullsListResponse>>} pulls
     */
    private pullsList;
    /**
     * @param {string} branchName branch name
     * @param {PullsCreateParams} detail detail
     * @param {GitHub} octokit octokit
     * @param {Context} context context
     * @return {Promise<PullsCreateResponse>} pull
     */
    pullsCreate: (branchName: string, detail: PullsCreateParams, octokit: GitHub, context: Context) => Promise<Response<PullsCreateResponse>>;
    /**
     * @param {number} number pull number
     * @param {PullsCreateParams} detail detail
     * @param {GitHub} octokit octokit
     * @param {Context} context context
     * @return {Promise<PullsUpdateResponse>} pull
     */
    pullsUpdate: (number: number, detail: PullsCreateParams, octokit: GitHub, context: Context) => Promise<Response<PullsUpdateResponse>>;
    /**
     * @param {Error} error error
     * @return {boolean} result
     */
    private isProtectedBranchError;
    /**
     * @param {string[]} files files
     * @return {boolean} diff?
     */
    private checkDiff;
    /**
     * @param {string} rootDir root dir
     * @param {string} commitMessage commit message
     * @param {string[]} files files
     * @param {GitHub} octokit octokit
     * @param {Context} context context
     * @return {Promise<Response<GitCreateCommitResponse>>} commit
     */
    private prepareCommit;
    /**
     * @param {string} rootDir root dir
     * @param {string} commitMessage commit message
     * @param {string[]} files files
     * @param {GitHub} octokit octokit
     * @param {Context} context context
     * @return {Promise<boolean>} result
     */
    commit: (rootDir: string, commitMessage: string, files: string[], octokit: GitHub, context: Context) => Promise<boolean>;
    /**
     * @param {string} rootDir root dir
     * @param {string} commitMessage commit message
     * @param {string[]} files files
     * @param {string} createBranchName branch name
     * @param {PullsCreateParams} detail detail
     * @param {GitHub} octokit octokit
     * @param {Context} context context
     * @return {Promise<boolean>} result
     */
    createPR: (rootDir: string, commitMessage: string, files: string[], createBranchName: string, detail: PullsCreateParams, octokit: GitHub, context: Context) => Promise<boolean>;
    /**
     * @param {GitHub} octokit octokit
     * @param {Context} context context
     * @return {Promise<{ login: string, email: string, name: string, id: number }>} user
     */
    getUser: (octokit: GitHub, context: Context) => Promise<{
        login: string;
        email: string;
        name: string;
        id: number;
    }>;
}
export {};
